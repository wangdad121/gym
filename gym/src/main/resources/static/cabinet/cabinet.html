<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>租柜管理</title>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../bootstrap/css/admin.css">
    <script src="../jquery.js"></script>
</head>
<body>
<h1>租柜管理页面</h1>
<a href="add.html">添加</a>
<p id="p1"></p>
<table id="table1" class="table table-bordered">
    <tr>
        <td>序号 </td>
        <td>编号</td>
        <td>容量</td>
        <td>状态</td>
        <td>操作</td>
    </tr>
</table>

</table>
<script>
      $.ajax({
          url:"/Cabinet/findAll",
          type:"get",
          success:function (result) {
              for (var a=0;a<result.length;a++){
                  var cabinet=result[a];
                  var $tr2=$("<tr></tr>");
                  var $td10=$("<td></td>").text(cabinet.cabid);
                  var $td11=$("<td></td>").text(cabinet.cabnumber);
                  if(cabinet.cabcapacity == 1){
                      var $td22=$("<td></td>").text("80 * 80 *100");
                  } if(cabinet.cabcapacity == 0){
                      var $td22=$("<td></td>").text("40 * 40 * 50");
                  }

                  var $td33=$("<td></td>").text(cabinet.cabstatus);
                  if(cabinet.cabstatus==1){
                      var $td33=$("<td></td>").text("空闲");
                  }
                  if(cabinet.cabstatus==2){
                      var $td33=$("<td></td>").text("已租");
                  }
                  if(cabinet.cabstatus==3){
                      var $td33=$("<td></td>").text("故障");
                  }
                  var $a1=$("<a></a>").addClass("glyphicon glyphicon-trash");
                //  $a2.attr("click"+cabinet.cabid);
                  var $a2=$("<a></a>").addClass("glyphicon glyphicon-pencil");
                  $a2.attr("href","cabinetUpdate.html?cabid="+cabinet.cabid);
                  $tr2.append($td10);
                  $tr2.append($td11);
                  $tr2.append($td22);
                  $tr2.append($td33);
                  $tr2.append($a1);
                  $tr2.append($a2);
                  $(table1).append($tr2);
              }
          }
      })
      $("table1").on("click",".glyphicon-trash",function () {
          var delet = this;
          alert($(delet).parent().prev().prev().prev().prev().text())
          $.ajax({
              url:"Cabinet/delete",
              type:"post",
              data:{
                  cabid:$(delet).parent().prev().prev().prev().text()
              },
              success:function (result) {
                  alert("删除成功");
                  $(delet).parent().parent().remove();
                  window.location.href = 'cabinet.html';
              }
          })
      })

</script>
</body>
</html>